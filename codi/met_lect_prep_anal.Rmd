---
title: "Meta_Analisi Associations of macrovascular complications with death in patients with diabetes hospitalized for Coronavirus disease(COVID-19)"
author: "Rai Puig & Jordi Real"
website: "https://github.com/USR-DAPCAT/"

date: "`r format(Sys.time(), '%d %B, %Y')`"


output:
  html_document:
    df_print: paged
    toc: true
    toc_float: true
    fig_caption: true
    css: logos_css/usr_styles.css
  pdf_document: default
  word_document: default

---

&nbsp;
<script>
   $(document).ready(function() {
     $head = $('#header');
     $head.prepend('<img src=\"https://www.idiapjgol.org/images/logo.png\" style=\"float: right ;width: 130px;\"/>')
     $head.prepend('<img src=\"https://avatars2.githubusercontent.com/u/57066591?s=200&v=4\" style=\"margin-left:25% ;width: 80px;\"/>')
     $head.prepend('<img src=\"logos_css/logoDAP_Cat.png\" style=\"float: left:1;width: 185px;\"/>')
   });
</script>


<div class="watermark">DRAFT</div>

****



# 0. State:

**Latest updates** 

> Febrer/2022

**Done**

* Meta_Analisi Associations of macrovascular complications DM and Covid-19: UK,France,Spain


**Pending**

* Error checking and debugging 

# Analysis

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE, include=F,size="huge")
packages <-c("metafor","esc","readxl","esc","dummies")

ipak<-function(pkg){
  new.pkg<-pkg[!(pkg%in%installed.packages()[,"Package"])]
  if (length(new.pkg))
    install.packages(new.pkg,dependencies=TRUE)
  sapply(pkg,require, character.only=TRUE)}

ipak(packages)

library("meta") 
library("dplyr")
library("ggplot2")
library("metafor")
library("esc")
library("dummies")

# Funcions 
link_source<-paste0("https://github.com/jrealgatius/Stat_codis/blob/master/funcions_propies.R","?raw=T")
devtools::source_url(link_source)


conductor<-here::here("conductor_meta_analisi.xlsx")


#https://www.rdocumentation.org/packages/meta/versions/1.1-2/topics/forest

```


```{r lectura, include = TRUE}

base_dades<-readxl::read_excel(conductor)


base_dades<-base_dades %>% select(COUNTRY=camp,LOG_OR=LOG2,SE_OR=SE2,OR_MACRO,I1,I2)

base_dades%>%
  kable(caption="Table of Meta-Analysis",digits = 2)%>% 
      kableExtra::kable_classic_2()

base_dades$LOG_OR<-as.numeric(base_dades$LOG_OR)
base_dades$SE_OR<-as.numeric(base_dades$SE_OR)



```



```{r recodes_analisis,include=TRUE}

#1# .	Death ~ Macrovascular disease (unadjusted)
#2# .	Death ~ Macrovascular disease + Age + Sex
#3# .	Death ~ Macrovascular disease + Age + Sex + Hypertension + Type of Diabetes + Microvascular disease 


#falta canviar SE-France



#LOG_OR	SE_OR

ROR_covid1<-base_dades%>%filter(COUNTRY=="UK1" | COUNTRY=="FRANCE1" | COUNTRY=="SPAIN1")%>%select(COUNTRY,LOG_OR,SE_OR)
ROR_covid2<-base_dades%>%filter(COUNTRY=="UK2" | COUNTRY=="FRANCE2" | COUNTRY=="SPAIN2")%>%select(COUNTRY,LOG_OR,SE_OR)
ROR_covid3<-base_dades%>%filter(COUNTRY=="UK3" | COUNTRY=="FRANCE3" | COUNTRY=="SPAIN3")%>%select(COUNTRY,LOG_OR,SE_OR)



meta<-metagen(TE=ROR_covid1$LOG_OR,
               seTE=ROR_covid1$SE_OR,
               studlab = ROR_covid1$COUNTRY,
               sm = 'OR',
               title = "Meta_Analisi Associations of macrovascular complications with death in patients with diabetes hospitalized for Coronavirus disease(COVID-19)")

#summary(meta)
forest(meta,fontsize=7.5, boxsize=0.8)



#ROR_covid2<-c(0.724,0.531,0.470)
#SE_covid2<-c(0.295,0.153,0.102)
#META_covid2 = c("UK","France","Spain")
#res2<-data.frame(cbind(ROR_covid2,SE_covid2))



meta2<-metagen(TE=ROR_covid2$LOG_OR,
               seTE=ROR_covid2$SE_OR,
               studlab = ROR_covid2$COUNTRY,
               sm = 'OR',
               title = "Meta_Analisi Associations of macrovascular complications with death in patients with diabetes hospitalized for Coronavirus disease(COVID-19)")

#summary(meta2)
forest(meta2,fontsize=7.5, boxsize=0.8)



#ROR_covid3<-c(0.781,0.372,0.445)
#SE_covid3<-c(0.303,0.155,0.105)
#META_covid3 = c("UK","France","Spain")
#res3<-data.frame(cbind(ROR_covid3,SE_covid3))
#


meta3<-metagen(TE=ROR_covid3$LOG_OR,
               seTE=ROR_covid3$SE_OR,
               studlab = ROR_covid3$COUNTRY,
               sm = 'OR',
               title = "Meta_Analisi Associations of macrovascular complications with death in patients with diabetes hospitalized for Coronavirus disease(COVID-19)")

#summary(meta3)
forest(meta3,fontsize=7.5, boxsize=0.8)


```

```



&nbsp;
<hr />
<p style="text-align: center;">A work by $Jordi Real$ $Rai Puig$ </a></p>
<p style="text-align: center;">$Llepali System$ </a></p>
<p style="text-align: center;"><span style="color: #808080;"><em><https://github.com/USR-DAPCAT/></em></span></p>


